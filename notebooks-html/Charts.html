<div id="ipython-notebook">
            <a class="interact-button" href="http://data8.berkeley.edu/hub/interact?repo=textbook&path=notebooks/imdb.csv&path=notebooks/Charts.ipynb">Interact</a>
            <div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Categorical-Data-and-Bar-Charts">Categorical Data and Bar Charts<a class="anchor-link" href="#Categorical-Data-and-Bar-Charts">¶</a></h2><p>Now that we have examined several graphics produced by others, it is time to produce some of our own. We will start with <em>bar charts</em>, a type of graph with which you might already be familiar. A bar chart shows the distribution of a <em>categorical variable</em>, that is, a variable whose values are categories. In human populations, examples of categorical variables include gender, ethnicity, marital status, country of citizenship, and so on.</p>
<p>A bar chart consists of a sequence of rectangular bars, one corresponding to each category. The length of each bar is proportional to the number of entries in the corresponding category.</p>
<p>We will start by drawing a bar chart of the genres of a set of movies. The data are in a table called <code>tableA</code>, which looks like this:</p></div></div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="n">tableA</span>
</pre></div></div></div>
<div class="output_html rendered_html output_subarea output_execute_result">
<table border="1" class="dataframe">
    <thead>
        <tr>
            <th>GENRE</th> <th>COUNT</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>Reality            </td> <td>3    </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>Multiple Genres    </td> <td>25   </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>Western            </td> <td>49   </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>Concert/Performance</td> <td>52   </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>Musical            </td> <td>130  </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>Black Comedy       </td> <td>138  </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>Horror             </td> <td>435  </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>Romantic Comedy    </td> <td>495  </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>Adventure          </td> <td>640  </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>Action             </td> <td>730  </td>
        </tr>
    </tbody>
</table>
<p>... (4 rows omitted)</p></div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The first column of <code>tableA</code> is labeled <code>GENRE</code>. It consists of the names of various genres of movie. More formally, it contains the names of the categories of the genre variable. The second column is labeled <code>COUNT</code>, and contains the number of movies in each genre.</p>
<p>The method <code>barh</code> can be applied to a table with two columns as above, to produce a bar chart consisting of horizontal bars. The horizontal orientation makes it easier to label the bars. The argument that <code>barh</code> requires is the name of the column consisting of the categories. The length of each bar is the count in that category.</p>
<p>Let us apply <code>barh</code> to <code>tableA</code>, with the <code>GENRE</code> column as its argument.</p></div></div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="n">tableA</span><span class="o">.</span><span class="n">barh</span><span class="p">(</span><span class="s">'GENRE'</span><span class="p">)</span>
</pre></div></div></div>
<div class="output_png output_subarea ">
<img src="Charts_6_0.png"/></div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>A different table called <code>tableB</code> also consists of movie genre data, in columns labled <code>GENRE</code> and <code>COUNT</code> just as in <code>tableA</code>. Here is a bar chart of the data in <code>tableB</code>.</p></div></div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="n">tableB</span><span class="o">.</span><span class="n">barh</span><span class="p">(</span><span class="s">'GENRE'</span><span class="p">)</span>
</pre></div></div></div>
<div class="output_png output_subarea ">
<img src="Charts_8_0.png"/></div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>At first glance, it applears that the two bar charts are quite different. One of them shows a distribution that looks like a smooth curve, while the other is quite irregular. However, closer inspection reveals that the two bar charts are in fact representations of exactly the same set of data. The only difference is in the order in which the categories appear. As we have seen before with graphs that involve two axes, it is important to study <em>both</em> axes carefully before making conclusions.</p>
<p>Unlike numbers, categories do not have a unique ordering relative to each other. The user determines the order in which they appear. In <code>tableA</code>, the categories are arranged so that the bars appear in decreasing order of length. In <code>tableB</code>, the categories are listed in alphabetical order. You could randomize the order; the data would tell the same story, though some orderings might make the story a little easier to read.</p>
<p>The data used in the bar charts above represent the market share for each genre of Hollywood movie, from 1995 to 2015. The source is the website <a href="http://www.the-numbers.com/market/genres">The Numbers</a>, subtitled "where data and the movie business meet."</p></div></div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Quantitative-Data-and-Histograms">Quantitative Data and Histograms<a class="anchor-link" href="#Quantitative-Data-and-Histograms">¶</a></h2><p>Many of the variables that data scientists study are <em>quantitative</em>. These are measurements of numerical variables such as income, height, age, and so on. In keeping with the movie theme of this section, we will study the amount of money grossed by movies in recent decades. Our source is the <a href="http://www.imdb.com">Internet Movie Database</a>. The IMDb is an online database that consists of a vast repository of information about movies, television shows, video games, and so on.</p>
<p>The table <code>imdb</code> consists of IMDb's data on <a href="http://www.imdb.com/boxoffice/alltimegross">U.S.A.'s top grossing movies</a> of all time. The first column contains the rank of the movie; <em>Avatar</em> has the top rank, with a box office gross amount of more than 760 million dollars in the United States. The second column contains the name of the movie; the third contains the U.S. box office gross in dollars; and the fourth contains the same gross amount, in millions of dollars.</p>
<p>There are 627 movies on the list. Here are the top ten.</p></div></div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="n">imdb</span> <span class="o">=</span> <span class="n">Table</span><span class="o">.</span><span class="n">read_table</span><span class="p">(</span><span class="s">'imdb.csv'</span><span class="p">)</span>
<span class="n">imdb</span>
</pre></div></div></div>
<div class="output_html rendered_html output_subarea output_execute_result">
<table border="1" class="dataframe">
    <thead>
        <tr>
            <th>rank</th> <th>movie</th> <th>boxoffice</th> <th>in_millions</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>1   </td> <td>Avatar (2009)                                   </td> <td>760505847</td> <td>760.506    </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>2   </td> <td>Titanic (1997)                                  </td> <td>658672302</td> <td>658.672    </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>3   </td> <td>Jurassic World (2015)                           </td> <td>642978555</td> <td>642.979    </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>4   </td> <td>The Avengers (2012)                             </td> <td>623279547</td> <td>623.28     </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>5   </td> <td>The Dark Knight (2008)                          </td> <td>533316061</td> <td>533.316    </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>6   </td> <td>Star Wars: Episode I - The Phantom Menace (1999)</td> <td>474544677</td> <td>474.545    </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>7   </td> <td>Star Wars (1977)                                </td> <td>460935665</td> <td>460.936    </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>8   </td> <td>Avengers: Age of Ultron (2015)                  </td> <td>457744064</td> <td>457.744    </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>9   </td> <td>The Dark Knight Rises (2012)                    </td> <td>448130642</td> <td>448.131    </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>10  </td> <td>Shrek 2 (2004)                                  </td> <td>436471036</td> <td>436.471    </td>
        </tr>
    </tbody>
</table>
<p>... (617 rows omitted)</p></div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Three-digit numbers (even with a few decimal places) are easier to work with than nine-digit numbers. So we will work with a smaller table called <em>mill</em>, created by selecting just the fourth column of <em>imdb</em>.</p>
<p>The method <em>hist</em> applied to one numerical column such as <em>mill</em> produces a figure called a <em>histogram</em> that looks very much like a bar chart. In this section, we will examine histograms and their properties.</p></div></div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="n">mill</span> <span class="o">=</span> <span class="n">imdb</span><span class="o">.</span><span class="n">select</span><span class="p">([</span><span class="s">'in_millions'</span><span class="p">])</span>
</pre></div></div></div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="n">mill</span><span class="o">.</span><span class="n">hist</span><span class="p">()</span>
</pre></div></div></div>
<div class="output_png output_subarea ">
<img src="Charts_14_0.png"/></div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The figure above shows the distribution of the amounts grossed, in millions of dollars. The amounts have been grouped into contiguous intervals called <em>bins</em>. Although in this dataset no movie grossed an amount that is exactly on the edge between two bins, it is worth noting that <em>hist</em> has an <em>endpoint convention</em>: bins include the data at their left endpoint, but not the data at their right endpoint. Sometimes, adjustments have to be made in the first or last bin, to ensure that the smallest and largest values of the variable are included. You saw an example of such an adjustment in the Census data used in the Tables section, where an age of "100" years actually meant "100 years old or older."</p>
<p>We can see that there are 10 bins (some bars are so low that they are hard to see), and that they all have the same width. We can also see that there the list contains no movie that grossed fewer than 100 million dollars; that is because we are considering only the top grossing movies of all time. It is a little harder to see exactly where the edges of the bins are placed. For example, it is not clear exactly where the value 200 lies on the horizontal axis, and so it is hard to judge exactly where the first bar ends and the second begins.</p>
<p>The optional argument <em>bins</em> can be used with <em>hist</em> to specify the edges of the bars. It must consist of a sequence of numbers that includes the left end of the first bar and the right end of the last bar. As the highest gross amount is somewhat over 760 on the horizontal scale, we will start by setting <em>bins</em> to be the array consisting of the numbers 100, 150, 200, 250, and so on, ending with 800.</p></div></div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="n">mill</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="mi">810</span><span class="p">,</span><span class="mi">50</span><span class="p">))</span>
</pre></div></div></div>
<div class="output_png output_subarea ">
<img src="Charts_16_0.png"/></div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This figure is easier to read. On the horizontal axis, the labels 100, 200, 300, and so on are centered at the corresponding values. The number of movies that grossed between 100 million and 150 million dollars appears to be around 340; the number that grossed between 150 million and 200 million dollars appears to be around 125; and so on.</p>
<p>A large majority of the movies grossed between 100 million and 250 million dollars. A very small number grossed more than 600 million dollars. This results in the figure being "skewed to the right,", or, less formally, having "a long right hand tail." Distributions of variables like income or rent often have this kind of shape.</p>
<p>The exact counts are given below. The entries of 250 million dollars or more have been collected in a single bin. The total of the counts is 627, which is the number of movies on the list.</p></div></div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="n">bins</span><span class="p">,</span> <span class="n">counts</span> <span class="o">=</span> <span class="p">[</span><span class="s">"[100, 150)"</span><span class="p">,</span> <span class="s">"[150,200)"</span><span class="p">,</span> <span class="s">"[200, 250)"</span><span class="p">,</span> <span class="s">"[250, 800)"</span><span class="p">],[</span><span class="mi">338</span><span class="p">,</span><span class="mi">129</span><span class="p">,</span><span class="mi">68</span><span class="p">,</span><span class="mi">92</span><span class="p">]</span>
<span class="n">bincounts</span> <span class="o">=</span> <span class="n">Table</span><span class="p">([</span><span class="n">bins</span><span class="p">,</span> <span class="n">counts</span><span class="p">],</span> <span class="p">[</span><span class="s">'bins'</span><span class="p">,</span><span class="s">'counts'</span><span class="p">])</span>
<span class="n">bincounts</span>
</pre></div></div></div>
<div class="output_html rendered_html output_subarea output_execute_result">
<table border="1" class="dataframe">
    <thead>
        <tr>
            <th>bins</th> <th>counts</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>[100, 150)</td> <td>338   </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>[150,200) </td> <td>129   </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>[200, 250)</td> <td>68    </td>
        </tr>
    </tbody>
        <tbody><tr>
            <td>[250, 800)</td> <td>92    </td>
        </tr>
    </tbody>
</table></div>
<div class="output_html rendered_html output_subarea output_execute_result">
<table border="1" class="dataframe">
    <thead>
        <tr>
            <th>counts</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>627   </td>
        </tr>
    </tbody>
</table></div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>What is wrong with this picture?</strong></p>
<p>Let us try to redraw the histogram with just four bins: [100, 150), [150, 200), [200, 250), and [250, 800). As we saw in the table of counts, the [250, 800) bin contains 92 movies.</p></div></div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="n">mill</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">bins</span><span class="o">=</span><span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">800</span><span class="p">])</span>
</pre></div></div></div>
<div class="output_png output_subarea ">
<img src="Charts_21_0.png"/></div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Even though the method used is called <em>hist</em>, <strong>the figure above is NOT A HISTOGRAM.</strong> It gives the impression that there are many more movies in the 250-800 bin than in the 100-150 bin, and indeed more than in the entire range 100-250. The height of each bar is simply plotted the number of movies in the bin, <em>without accounting for the difference in the widths of the bins</em>.</p>
<p><strong>So what is a histogram?</strong></p>
<p>The figure above shows that what the eye perceives as "big" is area, not just height. This is particularly important when the bins are of different widths.</p>
<p>That is why a histogram has two defining properties:</p>
<ol>
<li>The bins are contiguous (though some might be empty) and are drawn to scale.</li>
<li>The <strong>area</strong> of each bar is proportional to the number of entries in the bin. </li>
</ol>
<p>Property 2 is the key to drawing a histogram, and is usually achieved as follows:</p>
$$
\mbox{area of bar} ~=~ \mbox{proportion of entries in bin}
$$<p>When drawn using this method, the histogram is said to be drawn <em>on the density scale</em>, and the total area of the bars is equal to 1.</p>
<p>To calculate the height of each bar, use the fact that the bar is a rectangle:</p>
$$
\mbox{area of bar} = \mbox{height of bar} \times \mbox{width of bin}
$$<p>and so</p>
$$
\mbox{height of bar} ~=~ 
\frac{\mbox{area of bar}}{\mbox{width of bin}} ~=~
\frac{\mbox{proportion of entries in bin}}{\mbox{width of bin}}
$$<p>For <em>hist</em> to draw a histogram on the density scale, the Boolean option <em>normed</em> must have the value <em>True</em>. You can think of "normed" as shorthand for "follows the norm of the density scale."</p></div></div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="n">mill</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">bins</span><span class="o">=</span><span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">800</span><span class="p">],</span> <span class="n">normed</span><span class="o">=</span><span class="k">True</span><span class="p">)</span>
</pre></div></div></div>
<div class="output_png output_subarea ">
<img src="Charts_23_0.png"/></div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This is a reasonable representation of the data, though of course some detail has been lost. The level of detail in a histogram depends on the level of detail in the data as well as on the choices made by the user. Before we explore this idea further, let us first check that the numbers on the vertical axis above are consistent with the heights that we would calculate.</p>
<p>There are 129 movies in the [150, 200) bin. The proportion of movies in the bin is therefore 129/627, and the width of the bin is 200-150. So the height of the bar above that bin should be</p>
$$
\frac{129/627}{200-150} ~=~ 0.0041148325358851675
$$<p>That agrees with the height of the bar as shown in the figure. You might want to check that the other heights also agree with what you would calculate.</p>
<p><strong>The level of detail, and the flat tops of the bars</strong></p>
<p>Take another look at the [150, 200) bin in the figure above. The flat top of the bar, at the level 0.004, hides the fact that the movies are somewhat unevenly distributed across the bin. To see this, let us split the [150, 200) bin into five narrower bins of width 10 million dollars each:</p></div></div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="n">mill</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">bins</span><span class="o">=</span><span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">170</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">190</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">800</span><span class="p">],</span> <span class="n">normed</span><span class="o">=</span><span class="k">True</span><span class="p">)</span>
</pre></div></div></div>
<div class="output_png output_subarea ">
<img src="Charts_25_0.png"/></div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Some of the skinny bars are taller than 0.004 and others are shorter. By putting a flat top at 0.004 over the whole bin, we are deciding to ignore the finer detail and use the flat level as a rough approximation. Often, though not always, this is sufficient for understanding the general shape of the distribution.</p>
<p>Notice that because we have the entire dataset, we can draw the histogram in as fine a level of detail as the data and our patience will allow. However, if you are looking at a histogram in a book or on a website, and you don't have access to the underlying dataset, then it becomes important to have a clear understanding of the "rough approximation" of the flat tops.</p></div></div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>The density scale</strong></p>
<p>The height of each bar is a proportion divided by a bin width. Thus, for this datset, the values on the vertical axis are "proportions per million dollars." To understand this better, look again at the [150, 200) bin. The bin is 50 million dollars wide. So we can think of it as consisting of 50 narrow bins that are each 1 million dollars wide. The bar's height of roughly "0.004 per million dollars" means that in each of those 50 skinny bins of width 1 million dollars, the proportion of movies is roughly 0.004.</p>
<p>Thus the height of a histogram bar is a proportion per unit on the horizontal axis, and can be thought of as the <em>density</em> of entries per unit width.</p></div></div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="n">imdb</span><span class="o">.</span><span class="n">select</span><span class="p">([</span><span class="s">'in_millions'</span><span class="p">])</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">bins</span><span class="o">=</span><span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">800</span><span class="p">],</span> <span class="n">normed</span><span class="o">=</span><span class="k">True</span><span class="p">)</span>
</pre></div></div></div>
<div class="output_png output_subarea ">
<img src="Charts_28_0.png"/></div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Density Q&amp;A</strong></p>
<p>Look again at the histogram, and this time compare the [200, 250) bin with the [250, 800) bin.</p>
<p><strong>Q</strong>: Which has more movies in it?</p>
<p><strong>A</strong>: The [250, 800) bin. It has 92 movies, compared with 68 movies in the [200, 250) bin.</p>
<p><strong>Q</strong>: Then why is the [250, 800) bar shorter than the [200, 250) bar?</p>
<p><strong>A</strong>: Because height represents density per unit width, not the number of movies in the bin. The [250, 800) bin has more movies than the [200, 250) bin, but it is also a whole lot wider. So the density is much lower.</p></div></div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Bar chart or histogram?</strong></p>
<p>Bar charts display the distributions of categorical variables. All the bars in a bar chart have the same width. The lengths (or heights, if the bars are drawn vertically) of the bars are proportional to the number of entries.</p>
<p>Histograms display the distributions of quantitative variables. The bars can have different widths. The areas of the bars are proportional to the number of entries.</p>
<p><strong>Multiple bar charts and histograms</strong></p>
<p>In all the examples in this section, we have drawn a single bar chart or a single histogram. However, if a data table contains several columns, then <em>barh</em> and <em>hist</em> can be used to draw several graphs at once. We will cover this feature in a later section.</p></div></div></div>