<div id="ipython-notebook">
            <a class="interact-button" href="http://data8.berkeley.edu/hub/interact?repo=textbook&path=notebooks/baby.csv&path=notebooks/AB.ipynb">Interact</a>
            <div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Using-the-Bootstrap-Method-to-Test-Hypotheses">Using the Bootstrap Method to Test Hypotheses<a class="anchor-link" href="#Using-the-Bootstrap-Method-to-Test-Hypotheses">¶</a></h2><p>In the previous section we used the bootstrap method to estimate an unknown parameter. The bootstrap can also be used in statistical tests of hypotheses.</p>
<p>For example, suppose we want to compare the mothers who smoke and the mothers who are non-smokers. Do they differ in any way other than smoking? A key variable of interest is the birth weight of their babies. To study this variable, we begin by noting that there are 715 non-smokers among the women in the sample, and 459 smokers.</p></div></div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="n">baby</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">baby</span><span class="p">[</span><span class="s">'m_smoker'</span><span class="p">],</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">num_rows</span>
</pre></div></div></div>
<div class="output_text output_subarea output_execute_result">
<pre>715</pre></div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="n">baby</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">baby</span><span class="p">[</span><span class="s">'m_smoker'</span><span class="p">],</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">num_rows</span>
</pre></div></div></div>
<div class="output_text output_subarea output_execute_result">
<pre>459</pre></div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The first histogram below displays the distribution of birth weights, in ounces, of the babies of the non-smokers in the sample. The second displays the birth weights of the babies of the smokers.</p></div></div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="c"># birth weights of babies of non-smokers</span>
<span class="n">baby</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s">'birthwt'</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">baby</span><span class="p">[</span><span class="s">'m_smoker'</span><span class="p">],</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">bins</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">normed</span><span class="o">=</span><span class="k">True</span><span class="p">)</span>
<span class="n">plots</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">'birth weight (babies of non-smokers)'</span><span class="p">)</span>
</pre></div></div></div>
<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.text.Text at 0x10a1f14a8&gt;</pre></div>
<div class="output_png output_subarea ">
<img src="../notebooks-images/AB_6_1.png"/></div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="c"># birth weights of babies of smokers</span>
<span class="n">baby</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s">'birthwt'</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">baby</span><span class="p">[</span><span class="s">'m_smoker'</span><span class="p">],</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">bins</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">normed</span><span class="o">=</span><span class="k">True</span><span class="p">)</span>
<span class="n">plots</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">)</span>
<span class="n">plots</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">'birth weight (babies of smokers)'</span><span class="p">)</span>
</pre></div></div></div>
<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.text.Text at 0x10a769cf8&gt;</pre></div>
<div class="output_png output_subarea ">
<img src="../notebooks-images/AB_7_1.png"/></div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Both distributions are approximately bell shaped and centered near 120 ounces. The distributions are not identical, of course, which raises the question of whether the difference reflects just chance variation or a difference in the distributions in the population.</p>
<p>This question can be answered by a test of the null and alternative hypotheses below.</p></div></div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Null hypothesis.</strong> In the population, the distribution of birth weights of babies is the same for mothers who don't smoke as for mothers who do. The difference in the sample is due to chance.</p>
<p><strong>Alternative hypothesis.</strong> The two distributions are different in the population.</p>
<p>Birth weight is a quantitative variable, so it is reasonable to start the analysis by using the difference in means as the test statistic.</p>
<p>The observed difference in the means of the two groups in the sample is about 9.27 ounces, as shown in the calculation below. It starts by extracting just the two columns needed for the test – the label of smoker or non-smoker, and the birth weight of the baby. It then computes the mean birth weight of the babies of the non-smokers and the mean of the babies of the smokers, and takes the difference of the two means.</p></div></div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="n">sm_bwt</span> <span class="o">=</span> <span class="n">baby</span><span class="o">.</span><span class="n">select</span><span class="p">([</span><span class="s">'m_smoker'</span><span class="p">,</span><span class="s">'birthwt'</span><span class="p">])</span>
<span class="n">nonsmokers_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">sm_bwt</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">sm_bwt</span><span class="p">[</span><span class="s">'m_smoker'</span><span class="p">],</span><span class="mi">0</span><span class="p">)[</span><span class="s">'birthwt'</span><span class="p">])</span>
<span class="n">smokers_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">sm_bwt</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">sm_bwt</span><span class="p">[</span><span class="s">'m_smoker'</span><span class="p">],</span><span class="mi">1</span><span class="p">)[</span><span class="s">'birthwt'</span><span class="p">])</span>
<span class="n">nonsmokers_mean</span> <span class="o">-</span> <span class="n">smokers_mean</span>
</pre></div></div></div>
<div class="output_text output_subarea output_execute_result">
<pre>9.2661425720249184</pre></div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Method-1:-Permutation-Test">Method 1: Permutation Test<a class="anchor-link" href="#Method-1:-Permutation-Test">¶</a></h3><p>To see whether such a difference could have arisen due to chance under the null hypothesis, we could use a permutation test just as we did in Chapter 3. Let us perform that test first, and then see how the bootstrap method compares with it.</p>
<p>The code below performs the permutation test based on 10,000 random permutations. Note that as before, no sample size is provided to the method <code>sample</code>, because the default sample size is equal to the total number of rows in the table. The default sampling method of <code>sample</code> is to draw without replacement, which is exactly what is needed to create random permutations. This point will be important to recall when we switch to the bootstrap method.</p>
<p>Note also that the code starts by sorting the rows so that the rows corresponding to the 715 non-smokers appear first. This eliminates the need to use conditional expressions to identify the rows corresponding to smokers and non-smokers in each replication of the sampling process.</p></div></div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="sd">"""Permutation test for the difference in mean birthweight</span>
<span class="sd">Category A: non-smoker      Category B: smoker"""</span>

<span class="n">bwt_sorted</span> <span class="o">=</span> <span class="n">baby</span><span class="o">.</span><span class="n">select</span><span class="p">([</span><span class="s">'m_smoker'</span><span class="p">,</span> <span class="s">'birthwt'</span><span class="p">])</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="s">'m_smoker'</span><span class="p">)</span>

<span class="c"># calculate the observed difference in means</span>
<span class="n">meanA</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">bwt_sorted</span><span class="p">[</span><span class="s">'birthwt'</span><span class="p">][:</span><span class="mi">715</span><span class="p">])</span>
<span class="n">meanB</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">bwt_sorted</span><span class="p">[</span><span class="s">'birthwt'</span><span class="p">][</span><span class="mi">715</span><span class="p">:])</span>
<span class="n">obs_diff</span> <span class="o">=</span> <span class="n">meanA</span> <span class="o">-</span> <span class="n">meanB</span>

<span class="n">repetitions</span><span class="o">=</span><span class="mi">10000</span>
<span class="n">diffs</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">repetitions</span><span class="p">):</span>
    
    <span class="c"># sample WITHOUT replacement, same number as original sample size</span>
    <span class="n">resample</span> <span class="o">=</span> <span class="n">bwt_sorted</span><span class="o">.</span><span class="n">sample</span><span class="p">()</span>
    
    <span class="c"># Compute the difference of the means of the resampled values, between Categories A and B</span>
    <span class="n">dd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">resample</span><span class="p">[</span><span class="s">'birthwt'</span><span class="p">][:</span><span class="mi">715</span><span class="p">])</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">resample</span><span class="p">[</span><span class="s">'birthwt'</span><span class="p">][</span><span class="mi">715</span><span class="p">:])</span>
    <span class="n">diffs</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">dd</span><span class="p">])</span>

<span class="c"># Display results   </span>
<span class="n">diffs</span> <span class="o">=</span> <span class="n">Table</span><span class="p">([</span><span class="n">diffs</span><span class="p">],[</span><span class="s">'diff_in_means'</span><span class="p">])</span>
<span class="n">diffs</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">bins</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">normed</span><span class="o">=</span><span class="k">True</span><span class="p">)</span>
<span class="n">plots</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">'Approx null distribution of difference in means'</span><span class="p">)</span>
<span class="n">plots</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">'Permutation Test'</span><span class="p">)</span>
<span class="n">plots</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">plots</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s">'Observed difference in means: '</span><span class="p">,</span> <span class="n">obs_diff</span><span class="p">)</span>
</pre></div></div></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Observed difference in means:  9.26614257202
</pre></div>
<div class="output_png output_subarea ">
<img src="../notebooks-images/AB_12_1.png"/></div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The figure test shows that under the null hypothesis of equal distributions in the population, the empirical distribution of the difference between the sample means of the two groups is roughly bell shaped, centered at 0, stretching from about $-4$ ounces to $4$ ounces. The observed difference in the original sample is about 9.27 ounces, which is inconsistent with this distribution. So the conclusion of the test is that in the population, the distributions of birth weights of the babies of non-smokers and smokers are different.</p></div></div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Method-2:-Bootstrap-Test">Method 2: Bootstrap Test<a class="anchor-link" href="#Method-2:-Bootstrap-Test">¶</a></h3><p>The bootstrap test is identical to the permutation test in all but one respect: it samples <em>with</em> replacement instead of without.</p>
<p>Compare the code for the bootstrap test below to see that it differs from the code for the permutation test only in that the option <code>with_replacement=True</code> has been used in the call to <code>sample</code>, and the output has been labeled <code>Bootstrap Test</code>.</p></div></div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="sd">"""Bootstrap test for the difference in mean birthweight</span>
<span class="sd">Category A: non-smoker      Category B: smoker"""</span>

<span class="n">bwt_sorted</span> <span class="o">=</span> <span class="n">baby</span><span class="o">.</span><span class="n">select</span><span class="p">([</span><span class="s">'m_smoker'</span><span class="p">,</span> <span class="s">'birthwt'</span><span class="p">])</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="s">'m_smoker'</span><span class="p">)</span>

<span class="c"># calculate the observed difference in means</span>
<span class="n">meanA</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">bwt_sorted</span><span class="p">[</span><span class="s">'birthwt'</span><span class="p">][:</span><span class="mi">715</span><span class="p">])</span>
<span class="n">meanB</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">bwt_sorted</span><span class="p">[</span><span class="s">'birthwt'</span><span class="p">][</span><span class="mi">715</span><span class="p">:])</span>
<span class="n">obs_diff</span> <span class="o">=</span> <span class="n">meanA</span> <span class="o">-</span> <span class="n">meanB</span>

<span class="n">repetitions</span><span class="o">=</span><span class="mi">10000</span>
<span class="n">diffs</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">repetitions</span><span class="p">):</span>
    
    <span class="c"># sample WITH replacement, same number as original sample size</span>
    <span class="n">resample</span> <span class="o">=</span> <span class="n">bwt_sorted</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">with_replacement</span><span class="o">=</span><span class="k">True</span><span class="p">)</span>
    
    <span class="c"># Compute the difference of the means of the resampled values, between Categories A and B</span>
    <span class="n">dd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">resample</span><span class="p">[</span><span class="s">'birthwt'</span><span class="p">][:</span><span class="mi">715</span><span class="p">])</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">resample</span><span class="p">[</span><span class="s">'birthwt'</span><span class="p">][</span><span class="mi">715</span><span class="p">:])</span>
    <span class="n">diffs</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">dd</span><span class="p">])</span>

<span class="c"># Display results   </span>
<span class="n">diffs</span> <span class="o">=</span> <span class="n">Table</span><span class="p">([</span><span class="n">diffs</span><span class="p">],[</span><span class="s">'diff_in_means'</span><span class="p">])</span>
<span class="n">diffs</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">bins</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">normed</span><span class="o">=</span><span class="k">True</span><span class="p">)</span>
<span class="n">plots</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">'Approx null distribution of difference in means'</span><span class="p">)</span>
<span class="n">plots</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">'Bootstrap Test'</span><span class="p">)</span>
<span class="n">plots</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">plots</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s">'Observed difference in means: '</span><span class="p">,</span> <span class="n">obs_diff</span><span class="p">)</span>
</pre></div></div></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Observed difference in means:  9.26614257202
</pre></div>
<div class="output_png output_subarea ">
<img src="../notebooks-images/AB_15_1.png"/></div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Not surprisingly, the bootstrap empirical distribution of the difference in sample means under the null hypothesis is almost identical to that produced by random permutations, and the conclusion of the test is the same.</p></div></div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Bootstrap-A-B-testing">Bootstrap A-B testing<a class="anchor-link" href="#Bootstrap-A-B-testing">¶</a></h3><p>As we have seen, bootstrap resampling methods can be used in the same way as random permutations to test the equality of two distributions, one from Category A and the other from Category B of a population. This is a version of what is rather unimanginatively known as <em>A-B testing</em>.</p>
<p>Let us define a function <code>bootstrap_ab_test</code> that performs A-B testing using the bootstrap method and the difference in sample means as the test statistic. The null hypothesis is that the two underlying distributions in the population are equal; the alternative is that they are not.</p>
<p>The arguments of the function are:</p>
<ul>
<li>the name of the table that contains the data in the original sample</li>
<li>the label of the column containing the response variable (that is, the variable whose distribution is of interest)</li>
<li>the label of the column containing the code 0 for Category A and 1 for Category B</li>
<li>the number of repetitions of the resampling procedure</li>
</ul>
<p>The function returns the observed difference in means, the bootstrap empirical distribution of the difference in means, and the bootstrap empirical $P$-value. Because the alternative simply says that the two underlying distributions are different, the $P$-value is computed as the proportion of sampled differences that are at least as large in absolute value as the absolute value of the observed difference.</p></div></div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="sd">"""Bootstrap A/B test for the difference in the mean response</span>
<span class="sd">Assumes A=0, B=1"""</span>

<span class="k">def</span> <span class="nf">bootstrap_AB_test</span><span class="p">(</span><span class="n">samp_table</span><span class="p">,</span> <span class="n">response_label</span><span class="p">,</span> <span class="n">ab_label</span><span class="p">,</span> <span class="n">repetitions</span><span class="p">):</span>
    
    <span class="c"># Sort the sample table according to the A/B column; </span>
    <span class="c"># then select only the column of effects.</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">samp_table</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">ab_label</span><span class="p">)</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">response_label</span><span class="p">)</span>
    
    <span class="c"># Find the number of entries in Category A.</span>
    <span class="n">n_A</span> <span class="o">=</span> <span class="n">samp_table</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">samp_table</span><span class="p">[</span><span class="n">ab_label</span><span class="p">],</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">num_rows</span>
      
    <span class="c"># Calculate the observed value of the test statistic.</span>
    <span class="n">meanA</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">response</span><span class="p">[</span><span class="n">response_label</span><span class="p">][:</span><span class="n">n_A</span><span class="p">])</span>
    <span class="n">meanB</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">response</span><span class="p">[</span><span class="n">response_label</span><span class="p">][</span><span class="n">n_A</span><span class="p">:])</span>
    <span class="n">obs_diff</span> <span class="o">=</span> <span class="n">meanA</span> <span class="o">-</span> <span class="n">meanB</span>
    
    <span class="c"># Run the bootstrap procedure and get a list of resampled differences in means</span>
    <span class="n">diffs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">repetitions</span><span class="p">):</span>
        <span class="n">resample</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">with_replacement</span><span class="o">=</span><span class="k">True</span><span class="p">)</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">resample</span><span class="p">[</span><span class="n">response_label</span><span class="p">][:</span><span class="n">n_A</span><span class="p">])</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">resample</span><span class="p">[</span><span class="n">response_label</span><span class="p">][</span><span class="n">n_A</span><span class="p">:])</span>
        <span class="n">diffs</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">d</span><span class="p">])</span>
    
    <span class="c"># Compute the bootstrap empirical P-value</span>
    <span class="n">diff_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">diffs</span><span class="p">)</span>
    <span class="n">p_value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">count_nonzero</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">diff_array</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">obs_diff</span><span class="p">))</span><span class="o">/</span><span class="n">repetitions</span>
    
    <span class="c"># Display results</span>
    <span class="n">diffs</span> <span class="o">=</span> <span class="n">Table</span><span class="p">([</span><span class="n">diffs</span><span class="p">],[</span><span class="s">'diff_in_means'</span><span class="p">])</span>
    <span class="n">diffs</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">bins</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">normed</span><span class="o">=</span><span class="k">True</span><span class="p">)</span>
    <span class="n">plots</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">'Approx null distribution of difference in means'</span><span class="p">)</span>
    <span class="n">plots</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">'Bootstrap A-B Test'</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s">"Observed difference in means: "</span><span class="p">,</span> <span class="n">obs_diff</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s">"Bootstrap empirical P-value: "</span><span class="p">,</span> <span class="n">p_value</span><span class="p">)</span>
</pre></div></div></div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can now use the function <code>bootstrap_AB_test</code> to compare the smokers and non-smokers with respect to several different response variables. The tests show a significant difference between the two groups in birth weight (as shown earlier), gestational days, maternal age, and maternal pregnancy weight. It comes as no surprise that the two groups do not differ significantly in their mean heights.</p></div></div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="n">bootstrap_AB_test</span><span class="p">(</span><span class="n">baby</span><span class="p">,</span> <span class="s">'birthwt'</span><span class="p">,</span> <span class="s">'m_smoker'</span><span class="p">,</span> <span class="mi">10000</span><span class="p">)</span>
</pre></div></div></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Observed difference in means:  9.26614257202
Bootstrap empirical P-value:  0.0
</pre></div>
<div class="output_png output_subarea ">
<img src="../notebooks-images/AB_20_1.png"/></div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="n">bootstrap_AB_test</span><span class="p">(</span><span class="n">baby</span><span class="p">,</span> <span class="s">'gest_days'</span><span class="p">,</span> <span class="s">'m_smoker'</span><span class="p">,</span> <span class="mi">10000</span><span class="p">)</span>
</pre></div></div></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Observed difference in means:  1.97652238829
Bootstrap empirical P-value:  0.0376
</pre></div>
<div class="output_png output_subarea ">
<img src="../notebooks-images/AB_21_1.png"/></div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="n">bootstrap_AB_test</span><span class="p">(</span><span class="n">baby</span><span class="p">,</span> <span class="s">'mat_age'</span><span class="p">,</span> <span class="s">'m_smoker'</span><span class="p">,</span> <span class="mi">10000</span><span class="p">)</span>
</pre></div></div></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Observed difference in means:  0.80767250179
Bootstrap empirical P-value:  0.0203
</pre></div>
<div class="output_png output_subarea ">
<img src="../notebooks-images/AB_22_1.png"/></div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="n">bootstrap_AB_test</span><span class="p">(</span><span class="n">baby</span><span class="p">,</span> <span class="s">'mat_pw'</span><span class="p">,</span> <span class="s">'m_smoker'</span><span class="p">,</span> <span class="mi">10000</span><span class="p">)</span>
</pre></div></div></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Observed difference in means:  2.56033030151
Bootstrap empirical P-value:  0.041
</pre></div>
<div class="output_png output_subarea ">
<img src="../notebooks-images/AB_23_1.png"/></div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span class="n">bootstrap_AB_test</span><span class="p">(</span><span class="n">baby</span><span class="p">,</span> <span class="s">'mat_ht'</span><span class="p">,</span> <span class="s">'m_smoker'</span><span class="p">,</span> <span class="mi">10000</span><span class="p">)</span>
</pre></div></div></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Observed difference in means:  -0.0905891494127
Bootstrap empirical P-value:  0.5519
</pre></div>
<div class="output_png output_subarea ">
<img src="../notebooks-images/AB_24_1.png"/></div></div>